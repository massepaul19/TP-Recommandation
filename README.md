# RECOMMANDATION

Un syst√®me de recommandation complet impl√©ment√© en C, utilisant l'algorithme des k plus proches voisins (KNN) avec la corr√©lation de Pearson pour pr√©dire les pr√©f√©rences des utilisateurs.

## Par rapport au systeme 

Ici nous avons choisi d'implementer 02 tests : 
- le test en localhost : qui consiste au client et au serveur d'√™tre dans une m√™me machine et de fonctionner ensemble
- le test en r√©sau : ici nous utilisons le point d'acces pour mettre les machines (serveur + les clients ) en r√©seau et au pr√©alable nous lan√ßons l'execution c√¥t√© client sur les machines clientes et nous d√©marrons le serveur

###Gestion des erreurs et conflits : acces √† la ressource par plusieurs clients

Nous utilisons les threads pour pouvoir g√©rer ...
## 1. TRAITEMENT

## Resum√© Makefile

Pour faire simple, pour savoir comment executer le projet taper la commande make help

### -------------------------------------------
### ===== Aide ==========
### -------------------------------------------

help:
	@echo '=== MENU D''AIDE POUR LA COMPILATION  Paulo Masse ======'
	@echo 'make               - compiler tout le programme'
	@echo 'make run           - Executer le programme'
	@echo 'make runstatic     - Executer avec Biblio statique'
	@echo 'make rundyn        - Executer avec Biblio dynamique'
	@echo 'make rundynessai   - Executer avec 03 Biblios dynamique'
	@echo 'make serveur       - Demarrer avec le serveur'
	@echo 'make stop-serveur  - Arr√™ter le serveur'
	@echo 'make client        - Demarrer c√¥t√© client'
	@echo 'make adresse       - Voir les adresses disponibles'
	@echo 'make clean         - Nettoyage des fichiers'
	@echo 'make efface        - Nettoyage du terminal'


### Structure des Donn√©es

Le syst√®me utilise plusieurs structures pour g√©rer les donn√©es :
Plus d'informations dans chaque fichier d'entete sur les fonctions implement√©es.
Mais les autres structures utilisent la structure principale inclus grace √† #include "reco.h"

structure principale

```c
typedef struct {
    unsigned int id_user;
    int nb_fois;
} User;

typedef struct {
    unsigned int id_article;
    unsigned int id_cat;
    int nb_fois;
} Article;

typedef struct {
    unsigned int id_cat;
    int nb_fois;
} Categorie;

typedef struct {
    int id_user;
    int id_article;
    int id_cat;
    float evaluation;
    double timestamp;
} Transaction;
```

structure pour gerer KNN

```
typedef struct {
    User users[MAX_USERS];
    Article articles[MAX_ARTICLES];
    Transaction transactions[MAX_USERS * MAX_ARTICLES];
    
    int nb_users;
    int nb_articles;
    int nb_transactions;
    
    float matrice_evaluations[MAX_USERS][MAX_ARTICLES];
    double matrice_similarite[MAX_USERS][MAX_USERS];
    
    double moyenne_utilisateur[MAX_USERS];
    int nb_eval_utilisateur[MAX_USERS];
    
    int k;
    int donnees_chargees;
    int matrice_similarite_calculee;
} RecommandeurKNN;

typedef struct {
    unsigned int id_user;
    unsigned int id_article;
    float note_predite;
    float note_reelle;
    double confiance;
} Prediction;

typedef struct {
    int index_utilisateur;
    unsigned int id_utilisateur;
    double similarite;
} Voisin;

```

structure pour gerer GRAPHE
```
typedef struct {
    int **matrice_adjacence;
    int taille_totale;
    int nb_users;
    int nb_articles;
    int *map_users;
    int *map_articles;
    int *reverse_map_users;
    int *reverse_map_articles;
    int max_user_id;
    int max_article_id;
} GrapheBipartite;

typedef struct {
    float *pagerank_vector;
    int nb_iterations;
    float convergence;
} ResultatPageRank;
```

### Structure par rapport au client serveur


##Fonctionnalit√©s

### Fonctionnalit√©s de Traitement

1. Afficher les statistiques
2. Extraire les transactions entre deux dates
3. Nettoyer les donn√©es de test
4. Filtrer les donn√©es
5. Recharger les donn√©es depuis donnees.txt
6. Sauvegarder les structures s√©par√©es
0. Retour au menu principal

### Fonctionnalit√©s extraction


###Syst√®me de recommandation KNN

Options :
1. Calculer la matrice de Pearson
2. Tester des pr√©dictions individuelles Pearson(u , i)
3. Effectuer toutes les pr√©dictions sur le fichier de test
4. √âvaluer les performances
5. Sauvegarder les r√©sultats
6. Afficher les statistiques


###Syst√®me de recommandation Factorisation Matricielle



###Syst√®me de recommandation avec Graphes

===== MENU RECOMMANDATION - GRAPHE + PAGERANK =====

Options :
1. Lire les donn√©es d'entra√Ænement (Train.txt)
2. Construire le graphe bipartite
3. Appliquer PageRank
4. Sauvegarder les r√©sultats PageRank
5. Afficher exemple de recommandations
0. Nettoyer la m√©moire et quitter


1. Traitement et gestion des donn√©es                           ‚ïë
‚ïë  2. Extraction de donn√©es vers Train                         ‚ïë
‚ïë  3. Syst√®me de recommandation KNN                            ‚ïë
‚ïë  4. Syst√®me de recommandation Factorisation Matricielle      ‚ïë
‚ïë  5. Syst√®me de recommandation avec Graphes                   ‚ïë
‚ïë  6. √Ä propos du syst√®me                                      ‚ïë
‚ïë  0. Quitter le programme 

### Fichiers de Traitement

- `include/reco.h` : D√©finitions des structures et fonctions de base
- `src/reco.c` : Impl√©mentation des fonctions de traitement  
- `include/Algo_recommandation.h` : Interface pour les 3 t√¢ches KNN
- `src/Algo_recommandation.c` : Impl√©mentation des algorithmes KNN
- Limites : `MAX_USERS = 50`, `MAX_ARTICLES = 50`, `MAX_CATEGORIES = 50`

## 2. RECOMMANDATION KNN

### Principe de l'Algorithme

L'algorithme KNN (k-Nearest Neighbors) pour la recommandation fonctionne en trois √©tapes :

1. **Calcul de similarit√©** : Mesure la similitude entre utilisateurs
2. **S√©lection des voisins** : Identifie les k utilisateurs les plus similaires
3. **Pr√©diction** : Estime les notes bas√©es sur les pr√©f√©rences des voisins

### Structure Principale

```c
typedef struct {
    User users[MAX_USERS];
    Article articles[MAX_ARTICLES];
    Transaction transactions[MAX_USERS * MAX_ARTICLES];
    
    int nb_users;
    int nb_articles;
    int nb_transactions;
    
    float matrice_evaluations[MAX_USERS][MAX_ARTICLES];
    double matrice_similarite[MAX_USERS][MAX_USERS];
    double moyenne_utilisateur[MAX_USERS];
    
    int k;  // Nombre de voisins
} RecommandeurKNN;
```

### Trois T√¢ches Principales

#### üéØ **T√ÇCHE 1 : Pearson(train-data)**
```c
double** Pearson(const char* filename);
```
- **Entr√©e** : Fichier de donn√©es d'entra√Ænement
- **Sortie** : Matrice carr√©e de similarit√© entre utilisateurs
- **Objectif** : Construire le mod√®le de recommandation

**Processus :**
1. Chargement des transactions d'entra√Ænement
2. Construction de la matrice utilisateur-article
3. Calcul des moyennes par utilisateur
4. Calcul de la corr√©lation de Pearson entre tous les utilisateurs

**Formule de Pearson :**
```
Pearson(u,v) = Œ£(rui - rÃÑu)(rvi - rÃÑv) / ‚àö[Œ£(rui - rÃÑu)¬≤ √ó Œ£(rvi - rÃÑv)¬≤]
```

#### üéØ **T√ÇCHE 2 : Predict(ui)**
```c
float Predict(RecommandeurKNN* rec, unsigned int id_user, unsigned int id_article);
```
- **Entr√©e** : ID utilisateur et ID article
- **Sortie** : Note pr√©dite pour cet utilisateur sur cet article
- **Objectif** : Pr√©diction individuelle

**Processus :**
1. Identification des k voisins les plus similaires
2. S√©lection des voisins ayant not√© l'article
3. Calcul de la pr√©diction pond√©r√©e par la similarit√©

**Formule de pr√©diction :**
```
P(u,i) = rÃÑu + Œ£(sim(u,v) √ó (rvi - rÃÑv)) / Œ£|sim(u,v)|
```

#### üéØ **T√ÇCHE 3 : Predict-all(test-data)**
```c
int Predict_all(RecommandeurKNN* rec, const char* test_filename, 
                Prediction predictions[], int max_predictions);
```
- **Entr√©e** : Fichier de donn√©es de test
- **Sortie** : Ensemble de toutes les pr√©dictions
- **Objectif** : √âvaluation compl√®te du mod√®le

**M√©triques d'√©valuation :**
- **RMSE** : `‚àö(Œ£(pr√©dite - r√©elle)¬≤ / n)`
- **MAE** : `Œ£|pr√©dite - r√©elle| / n`
- **Pr√©cision** : Pourcentage de pr√©dictions dans une marge d'erreur

### Structures Auxiliaires

```c
typedef struct {
    unsigned int id_user;
    unsigned int id_article;
    float note_predite;
    double confiance;
} Prediction;

typedef struct {
    int index_utilisateur;
    unsigned int id_utilisateur;
    double similarite;
} Voisin;
```

## 3. UTILISATION

### Compilation

Le projet utilise un Makefile pour la compilation :

```bash
# Compilation compl√®te
make

# Compilation version statique
make static

# Compilation version dynamique  
make dynamic

# Nettoyage
make clean

# Ex√©cution
./bin/cisse.out
```

### Biblioth√®ques Disponibles

Au choix.
- **libreco.a** : Biblioth√®que statique contenant les fonctions de traitement
- **libreco.so** : Biblioth√®que dynamique pour une utilisation modulaire

Pour des tests sans le serveur ni  client, nous avons propos√© √† l'utilisateur 03 m√©thodes d'√©x√©cution 
Mais, dans le cadre du serveur et client nous avons utilis√© la bibliotheque dynamique
Pourquoi ? parcequ'elle consomme moins et elle est charg√©e √† l'√©x√©cution ce qui nous fait un gain

### Exemple d'Utilisation Compl√®te

#

## 4. FORMAT DES DONN√âES

### Fichier de Transactions (data/essai/Train.txt, Test.txt , data/donn√©es.txt)
```
id_user id_article id_categorie evaluation timestamp
1       101        5           4.5        1609459200.0
1       102        3           3.0        1609545600.0
2       101        5           5.0        1609632000.0
```

data/donn√©es.txt : est notre fichier contenant des donn√©es brutes que nous avons pu g√©nerer √† partir de script python 
data/essai/Train.txt , data/Train_KNN/Train.txt contient une partie de donn√©es de tests recup√©r√©es dans nos donn√©es brutes

### Fichiers Auxiliaires

- `data/Users.txt` : Liste des utilisateurs extraits
- `data/Articles.txt` : Liste des articles extraits  
- `data/Categories.txt` : Liste des cat√©gories
- `data/donnees.txt` : Donn√©es brutes compl√®tes
- `data/transactions_filtrees.txt` : Donn√©es apr√®s filtrage par fr√©quence

### Fichier de Sortie des Pr√©dictions
```
id_user id_article note_reelle note_predite confiance
1       103        4.0         3.8          0.85
2       104        3.5         3.2          0.72
```

## 5. PARAM√àTRES ET CONFIGURATION

### Param√®tres Principaux
- **k** : Nombre de voisins (recommand√© : 5-20)
- **Seuil de similarit√©** : Minimum pour consid√©rer un voisin
- **Taille maximale** : D√©finie par les constantes MAX_*

### Optimisations Possibles
- **Filtrage pr√©alable** : Suppression des utilisateurs/articles peu actifs
- **Normalisation** : Centrage des notes par utilisateur
- **Pond√©ration temporelle** : Prise en compte de l'anciennet√© des √©valuations

## 6. STRUCTURE DU PROJET

```
.
‚îú‚îÄ‚îÄ bin/                        # Ex√©cutables compil√©s
‚îÇ   ‚îú‚îÄ‚îÄ cisse.out              # Ex√©cutable principal
‚îÇ   ‚îú‚îÄ‚îÄ rundyn                 # Version dynamique
‚îÇ   ‚îî‚îÄ‚îÄ runstatic              # Version statique
‚îú‚îÄ‚îÄ data/                      # Donn√©es du projet
‚îÇ   ‚îú‚îÄ‚îÄ Articles.txt           # Liste des articles
‚îÇ   ‚îú‚îÄ‚îÄ Categories.txt         # Liste des cat√©gories
‚îÇ   ‚îú‚îÄ‚îÄ Users.txt              # Liste des utilisateurs
‚îÇ   ‚îú‚îÄ‚îÄ donnees.txt            # Donn√©es brutes compl√®tes
‚îÇ   ‚îú‚îÄ‚îÄ transactions_filtrees.txt  # Donn√©es filtr√©es
‚îÇ   ‚îú‚îÄ‚îÄ transactions_t1-t2.txt     # Donn√©es par p√©riode
‚îÇ   ‚îî‚îÄ‚îÄ essai/                 # Jeu de donn√©es d'essai
‚îÇ       ‚îú‚îÄ‚îÄ Train.txt          # Donn√©es d'entra√Ænement
‚îÇ       ‚îú‚îÄ‚îÄ Test.txt           # Donn√©es de test
‚îÇ       ‚îî‚îÄ‚îÄ Clean.txt          # Donn√©es nettoy√©es
‚îú‚îÄ‚îÄ include/                   # Fichiers d'en-t√™te
‚îÇ   ‚îú‚îÄ‚îÄ reco.h                # Structures de base et traitement
‚îÇ   ‚îú‚îÄ‚îÄ Algo_recommandation.h # Interface KNN (vos 3 t√¢ches)
‚îÇ   ‚îî‚îÄ‚îÄ menu.h                # Interface utilisateur
‚îú‚îÄ‚îÄ src/                      # Code source
‚îÇ   ‚îú‚îÄ‚îÄ reco.c                # Impl√©mentation du traitement
‚îÇ   ‚îú‚îÄ‚îÄ Algo_recommandation.c # Impl√©mentation KNN
‚îÇ   ‚îî‚îÄ‚îÄ menu.c                # Interface utilisateur
‚îú‚îÄ‚îÄ lib/                      # Biblioth√®ques
‚îÇ   ‚îú‚îÄ‚îÄ libreco.a             # Biblioth√®que statique
‚îÇ   ‚îî‚îÄ‚îÄ libreco.so            # Biblioth√®que dynamique
‚îú‚îÄ‚îÄ obj/                      # Fichiers objets compil√©s
‚îÇ   ‚îú‚îÄ‚îÄ main.o
‚îÇ   ‚îî‚îÄ‚îÄ reco.o
‚îú‚îÄ‚îÄ test/                     # Tests et programme principal
‚îÇ   ‚îî‚îÄ‚îÄ main.c                # Point d'entr√©e du programme
‚îú‚îÄ‚îÄ Makefile                  # Script de compilation
‚îî‚îÄ‚îÄ TP3-INF 3621_Programmation Syst√®me.pdf  # Documentation du TP
```

.
‚îú‚îÄ‚îÄ bin
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ cisse.out
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ rundyn
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ runstatic
‚îú‚îÄ‚îÄ data
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Articles.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Categories.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ donnees.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ essai
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Clean.txt
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Test.txt
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ Train.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ KNN_TRAIN
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ resultats_predictions.txt
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Test.txt
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ Train.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ transactions_filtrees.txt
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ transactions_t1-t2.txt
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ Users.txt
‚îú‚îÄ‚îÄ donn√©es.txt
‚îú‚îÄ‚îÄ genere.py
‚îú‚îÄ‚îÄ include
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ factorisation.h
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ graphe.h
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ menu.h
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ reco.h
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ reco_KNN.h
‚îú‚îÄ‚îÄ lib
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ librecommantion.a
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ librecommantion.so
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ network
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ client.c
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ include
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ fonctions_client.h
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ fonctions_serveur.h
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ serveur.c
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ src
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ fonctions_client.c
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ fonctions_serveur.c
‚îú‚îÄ‚îÄ obj
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ graphe.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ graphe_pic.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ menu.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ reco_KNN.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ reco_KNN_pic.o
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ reco.o
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ reco_pic.o
‚îú‚îÄ‚îÄ pagerank_results.txt
‚îú‚îÄ‚îÄ projet
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ include
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ factorisation.h
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Makefile
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ network
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ client.c
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ include
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ fonctions_client.h
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ fonctions_serveur.h
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ serveur.c
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ src
‚îÇ¬†¬† ‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ fonctions_client.c
‚îÇ¬†¬† ‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ fonctions_serveur.c
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ src
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ factorisation.c
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ test
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ main.c
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ reseau
‚îú‚îÄ‚îÄ src
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ factorisation.c
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ graphe.c
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ menu.c
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ reco.c
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ reco_KNN.c
‚îú‚îÄ‚îÄ test
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ main.c
‚îú‚îÄ‚îÄ test.c
‚îú‚îÄ‚îÄ Text.txt
‚îú‚îÄ‚îÄ TP3-INF 3621_ Programmation Syst√®me.pdf
‚îú‚îÄ‚îÄ Tp-recommandation_sockets.pdf
‚îî‚îÄ‚îÄ Train.txt

## 7. R√âF√âRENCES

- **Algorithme KNN** : Collaborative Filtering Recommender Systems
- **Corr√©lation de Pearson** : Mesure de similarit√© statistique
- **√âvaluation** : M√©triques RMSE et MAE pour les syst√®mes de recommandation

---

*D√©velopp√© dans le cadre d'un projet de syst√®me de recommandation utilisant l'algorithme des k plus proches voisins avec corr√©lation de Pearson.*

## 7. Structures : Pourquoi avons nous choisi cel√† ?

Dans le traitement, le code utilise une fonction ecriretransaction telle que lorsque quelles est appel√©es sur un fichier, celle si mets √† jour tous les autres fichiers

Nous avons cr√©√© plusieurs autres fichiers adpt√©s √† notre structure afin de r√©pondre plus facilement aux questions du traitement qui est la base de notre travail

## Explication des fichiers objets

Nous avons respectivement 

DOSSIER_OBJET = ./obj/main.o ./obj/reco.o ./obj/reco_KNN.o ./obj/menu.o ./obj/graphe.o   #ici c'est pour lancer l'executable principal
OBJET_biblio_dyn = ./obj/reco_pic.o ./obj/reco_KNN_pic.o ./obj/graphe_pic.o // c'est pour lancer avec la biblio dynamique
OBJET_biblio_stac = ./obj/reco.o ./obj/reco_KNN.o ./obj/graphe.o //c'est pour lancer la biblio statique

## 7. Explication du Makefile

